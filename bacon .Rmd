```{r}
library(rvest)
library(stringr)

# Define the common part of the URL
common_url <- "https://www.imdb.com/list/ls006266261/?sort=list_order,asc&st_dt=&mode=detail&page="

# Extract the numbers from the common part of the URL
numbers <- 1:10

# Generate the complete URLs by joining the common part with the numbers
urls <- str_c(common_url, numbers)

# Initialize empty lists to store all titles, actors, directors, ratings, and profits
all_titles <- c()
all_actors <- c()
all_directors <- c()
all_ratings <- c()
all_profits <- c()

# Loop through each URL
for (url in urls) {
  # Read HTML content of the webpage
  webpage <- read_html(url)
  
  # Find titles, actors, directors, ratings, and profits based on CSS selectors
  titles <- webpage %>% html_nodes(".lister-item-index+ a")
  actors <- webpage %>% html_nodes(".ghost~ a , .mode-detail:nth-child(17) .text-small a")
  directors <- webpage %>% html_nodes(".text-muted a:nth-child(1)")
  ratings <- webpage %>% html_nodes(".ipl-rating-star.small .ipl-rating-star__rating")
  profits <- webpage %>% html_nodes(".ghost~ .text-muted+ span")
  
  # Extract text content of the nodes
  titles_text <- titles %>% html_text()
  actors_text <- actors %>% html_text()
  directors_text <- directors %>% html_text()
  ratings_text <- ratings %>% html_text()
  profits_text <- profits %>% html_text()
  
  # Append titles, actors, directors, ratings, and profits to the vectors
  all_titles <- c(all_titles, titles_text)
  all_actors <- c(all_actors, actors_text)
  all_directors <- c(all_directors, directors_text)
  all_ratings <- c(all_ratings, ratings_text)
  all_profits <- c(all_profits, profits_text)
}

# Remove actors number 65 and 66 from the list of actors
all_actors <- all_actors[-c(65, 66, 867, 1268, 1669, 2070, 2471, 3272, 3673)]
#all_profits <- all_profits[-c(1,2)]

# Calculate the number of iterations based on the length of all_actors
iterations <- length(all_actors) %/% 4

# Initialize empty lists to store combined data
combined_list <- vector("list", iterations)

# Iterate through the lists
for (i in 1:iterations) {
  start_idx <- (i - 1) * 4 + 1
  end_idx <- i * 4
  combined_list[[i]] <- list(
    Title = all_titles[i],
    Actor1 = all_actors[start_idx],
    Actor2 = all_actors[start_idx + 1],
    Actor3 = all_actors[start_idx + 2],
    Actor4 = all_actors[start_idx + 3],
    Director = all_directors[i],
    Rating = all_ratings[i],
    Profit = all_profits[i]
  )
}

# Convert the list to a data frame
df <- do.call(rbind, combined_list)

# Print the resulting data frame
View(df)
```
